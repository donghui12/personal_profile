# 🧩 中间件使用与实践经验

记录我在工作中使用各类中间件的方式、场景、注意事项与最佳实践。

---

## 1. Redis

- 用途：用户登录状态缓存、接口防刷、延迟队列、消息订阅（Pub/Sub）。
- 使用经验：
  - 常用数据结构：Hash / List / Sorted Set。
  - 避免大 Key，定期监控内存。
  - 登录态设置带过期时间，防止堆积。

---

## 2. OSS（对象存储）

- 用途：模型文件缓存、备份边端数据。
- 实践经验：
  - 使用阿里云 OSS SDK 上传/下载文件。
  - 搭配签名 URL 实现临时授权访问。
  - 上传后记录文件元信息到数据库，确保一致性。

---

## 3. MQTT

- 用途：云边消息通道，边缘设备与云端系统通信。
- 使用方式：
  - 主题结构规范化，例如：`edge/<device_id>/status`
  - 设置 QoS 等级确保消息可靠性。
  - 保持连接心跳，处理断线重连机制。

---

## 4. Prometheus

- 用途：采集平台运行时指标（接口延迟、系统资源占用等）。
- 实践经验：
  - 使用 `Prometheus Client` 暴露自定义指标。
  - 自建告警规则（如 CPU > 90% 超过 5min）。
  - 配合 Grafana 进行可视化展示。

---

## 5. RPC（gRPC）

- 用途：服务间高性能通信。
- 使用经验：
  - 定义 `.proto` 文件，自动生成服务代码。
  - 接入认证 token 拦截器，增强安全性。
  - 结合服务注册发现组件（如 Consul / etcd）。

---

## 6. 其他中间件

- **服务网格**：Istio / 自研网格组件，用于流量控制、认证鉴权。
- **审批中心中间件**：用于流程编排、状态流转管理。
- **CI/CD 工具链**：如 Jenkins / GitHub Actions 自研集成。

---

👉 后续每个中间件都可以独立扩展为专门笔记文件，如 `middleware/redis.md`、`middleware/mqtt.md`。